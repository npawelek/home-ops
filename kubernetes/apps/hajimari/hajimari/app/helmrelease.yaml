---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: hajimari
spec:
  chartRef:
    kind: OCIRepository
    name: hajimari
  interval: 1h
  values:
    controllers:
      hajimari:
        annotations:
          reloader.stakater.com/auto: "true"
        containers:
          app:
            image:
              repository: ghcr.io/toboshii/hajimari
              tag: v0.3.1@sha256:2ee4cab12878fd0771092bf1b7e271f2715731d2ba60d92461f8010094cda994
            env:
              TZ: ${TIMEZONE}
            resources:
              requests:
                cpu: 100m
                memory: 128Mi
              limits:
                memory: 256Mi
    service:
      app:
        ports:
          http:
            port: 3000
    route:
      app:
        hostnames: ["{{ .Release.Name }}.${SECRET_DOMAIN}"]
        parentRefs:
          - name: envoy-internal
            namespace: gateway
            sectionName: https
        rules:
          - backendRefs:
              - identifier: app
                port: 3000
    configMaps:
      config:
        data:
          config.yaml: |
            defaultEnable: false
            namespaceSelector:
              any: true
            name: "Nathan"
            darkTheme: "chalk"
            defaultSearchProvider: "DuckDuckGo"
            showAppStatus: true
            customApps:
              - group: downloads
                apps:
                  - name: Jellyseerr
                    icon: mdi:jellyfish
                    url: https://jellyseerr.${SECRET_DOMAIN}
                  - name: Sonarr
                    icon: mdi:television-classic
                    url: https://sonarr.${SECRET_DOMAIN}
                  - name: Sonarr Remux
                    icon: mdi:television-classic
                    url: https://sonarr-remux.${SECRET_DOMAIN}
                  - name: Sonarr Anime
                    icon: mdi:television-classic
                    url: https://sonarr-anime.${SECRET_DOMAIN}
                  - name: SABnzbd
                    icon: mdi:download
                    url: https://sabnzbd.${SECRET_DOMAIN}
                  - name: Radarr
                    icon: mdi:filmstrip
                    url: https://radarr.${SECRET_DOMAIN}
                  - name: Radarr Remux
                    icon: mdi:filmstrip
                    url: https://radarr-remux.${SECRET_DOMAIN}
                  - name: Radarr Anime
                    icon: mdi:filmstrip
                    url: https://radarr-anime.${SECRET_DOMAIN}
                  - name: Prowlarr
                    icon: mdi:movie-search
                    url: https://prowlarr.${SECRET_DOMAIN}
                  - name: Pinchflat
                    icon: mdi:youtube
                    url: https://pinchflat.${SECRET_DOMAIN}
                  - name: Bazarr
                    icon: mdi:filmstrip
                    url: https://bazarr.${SECRET_DOMAIN}
              - group: media
                apps:
                  - name: Jellyfin
                    icon: simple-icons:jellyfin
                    url: https://jellyfin.${SECRET_DOMAIN}
              - group: transcode
                apps:
                  - name: Unmanic
                    icon: mdi:cog-transfer
                    url: https://unmanic.${SECRET_DOMAIN}
              - group: network
                apps:
                  - name: Echo
                    icon: mdi:download-network-outline
                    url: https://echo.${SECRET_DOMAIN}
            globalBookmarks:
              - group: node
                bookmarks:
                  - name: home-ops
                    url: https://github.com/npawelek/home-ops
                  - name: Firmware
                    url: https://github.com/npawelek/firmware
              - group: network
                bookmarks:
                  - name: UniFi Network
                    url: https://udmp.${SECRET_DOMAIN}
                  - name: AWS
                    url: https://${AWS_LOGIN_ALIAS}.signin.aws.amazon.com
              - group: storage
                bookmarks:
                  - name: Synology RS1221+
                    url: https://racknas.${SECRET_DOMAIN}:8079
                  - name: Synology DS1512+
                    url: https://derpnas.${SECRET_DOMAIN}:8079
              - group: miscellaneous
                bookmarks:
                  - name: Pool Dashboard
                    url: http://pool.${SECRET_DOMAIN}
                  - name: Valetudo (Floofeater)
                    url: http://floofeater.${SECRET_DOMAIN}
                  - name: Valetudo (Rosie)
                    url: http://rosie.${SECRET_DOMAIN}
                  - name: HDHomeRun
                    url: http://hdhomerun.${SECRET_DOMAIN}
                  - name: HyperHDR Samsung 55
                    url: https://hyp-samsung55.${SECRET_DOMAIN}
                  - name: Octoprint
                    url: https://octopi.${SECRET_DOMAIN}
    persistence:
      config-file:
        type: configMap
        identifier: config
        globalMounts:
          - path: /config/config.yaml
            subPath: config.yaml
